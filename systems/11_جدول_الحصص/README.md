# ๐ ุฌุฏูู ุงูุญุตุต ุงูุฐูู (Intelligent Timetable)
## ุงููุณุฎุฉ 2.0 - ูุญุฑู ุฌุฏููุฉ ูุทูู ๐๏ธ

---

## ๐ ุจุทุงูุฉ ุงููุธุงู
| ุงูุจูุฏ | ุงููููุฉ |
|-------|--------|
| **ุงููููุฏุณ ุงููุณุคูู** | ููุณู ุงูุนูุงุถู (ุชุตููู ูุงุนุชูุงุฏ) |
| **ุนุฏุฏ ุงูุฌุฏุงูู** | 15 ุฌุฏููุงู ูุฑูุฒูุงู |
| **ุญุงูุฉ ุงููุฑุงุฌุนุฉ** | โญโญโญโญโญ (Enterprise Grade) |
| **ููู DDL** | `DDL.sql` |

---

## ๐ ุงูููุฏูุฉ
ุจูุงุก ุงูุฌุฏูู ุงููุฏุฑุณู ูุงู ุฏุงุฆูุงู "ุงููุงุจูุณ ุงูุณููู" ููููุงุก ุงููุฏุงุฑุณุ ุฃูุงู ูู ุงูุนูู ุงูุดุงู ูุชูููู ุฌุฏุงูู ุนุดุฑุงุช ุงููุนูููู ูุน ูุฆุงุช ุงููุตููุ ูุบุงูุจุงู ูุง ููุชูู ุงูุฃูุฑ ุจุชุนุงุฑุถุงุช ููุดุงูู. ูุธุงู ุฌุฏูู ุงูุญุตุต ุงูุฐูู ูููู ูุฐู ุงููุนุงูุงุฉ ุชูุงูุงูุ ุญูุซ ูููู ุงูุนูู ุงูุฅููุชุฑููู ุจุญู "ุงูุฃุญุฌูุฉ" ุงููุนูุฏุฉ ูู ุฏูุงุฆูุ ููุฒูุนุงู ุงูุญุตุต ุจุนุฏุงูุฉ ูููุงุกุฉ ูุง ูููู ููุนูู ุงูุจุดุฑู ูุฌุงุฑุงุชูุง.

## โ ูุงุฐุง ููุฏูู ูุฐุง ุงููุธุงูุ
ูุญุฑู ุฐูุงุก ุงุตุทูุงุนู ูุตุบุฑ ูููู ุจู:
- **ุชูุฒูุน ุงูุญุตุต:** ุฅุณูุงุฏ ูู ูุงุฏุฉ ููุนูููุง ูู ุงูุชูููุช ุงูููุงุณุจ.
- **ููุน ุงูุชุนุงุฑุถ:** ุถูุงู ุงุณุชุญุงูุฉ ูุฌูุฏ ูุนูู ูู ูุตููู ูู ููุช ูุงุญุฏ.
- **ุงูููุงุฒูุฉ:** ุชูุฒูุน ุงูุญุตุต ุงูุซูููุฉ (ูุงูุฑูุงุถูุงุช) ุนูู ุฃูุงู ุงูุฃุณุจูุนุ ูุนุฏู ุชูุฏูุณูุง ูู ููู ูุงุญุฏ.

## ๐ ุงูููุงุฆุฏ ุงูููููุณุฉ (ุงููุงุจูุฉ ููููุงุณ)
- **ุณุฑุนุฉ ุงูุฅูุฌุงุฒ:** ุชุฌููุฒ ุฌุฏูู ูุฏุฑุณุฉ ูุงููุฉ ูู ุฃูู ูู ุณุงุนุฉ.
- **ุชูุฒูุน ุนุงุฏู ูููุนูููู:** ูุฑุงุนู "ูุตุงุจ ุงูุญุตุต" ููุง ูุธูู ูุนููุงู ุจุถุบุท ูู ููู ููุฑุงุบ ูู ุขุฎุฑ.
- **ุงุณุชุบูุงู ุงููุฑุงุบุงุช:** ุชูููู ุญุตุต ุงูุงูุชุธุงุฑ ุบูุฑ ุงูุถุฑูุฑูุฉ.

## ๐ ุงูููุงุฆุฏ ุบูุฑ ุงูููููุณุฉ (ุงููููุฉ ุงูุฅุฏุงุฑูุฉ)
- **ุงูุฑุถุง ุงููุธููู:** ุงููุนูููู ูุดุนุฑูู ุจุงูุนุฏุงูุฉ ูู ุงูุชูุฒูุน.
- **ุงููุฑููุฉ:** ุงููุฏุฑุฉ ุนูู ุฅุตุฏุงุฑ "ุฌุฏูู ูุคูุช" ูุฑูุถุงู ุฃู ูุชุฑุฉ ุงูุงุฎุชุจุงุฑุงุช ุจุถุบุทุฉ ุฒุฑ.
- **ุงูุงุณุชูุฑุงุฑ:** ุจุฏุงูุฉ ุงูุนุงู ุงูุฏุฑุงุณู ุจุงูุชุธุงู ุชุงู ูู ุงูุญุตุฉ ุงูุฃููู.

## ๐ ููู ูุนูู ุงููุธุงูุ (ุจุฃุณููุจ ูุจุณูุท)
1. **ุงููุนุทูุงุช:** ูุฎุจุฑ ุงููุธุงู ุจู (ูู ูู ุงููุนููููุ ููุงุฐุง ูุฏุฑุณููุ ูุบุฑู ุงููุตูู ุงููุชุงุญุฉ).
2. **ุงููููุฏ:** ูุญุฏุฏ ุงูุดุฑูุท (ูุซูุงู: ูุนูู ุงูููุฒูุงุก ูุง ูุณุชุทูุน ุงูุญุถูุฑ ููู ุงูุฎููุณ).
3. **ุงููุนุงูุฌุฉ:** ูููู ุงููุธุงู ุจุชุฌุฑุจุฉ ุขูุงู ุงูุงุญุชูุงูุงุช ูู ุซูุงูู ุญุชู ูุตู ููุญู ุงูุฃูุซู.
4. **ุงููุดุฑ:** ุงุนุชูุงุฏ ุงูุฌุฏูู ูุทุจุงุนุชู ููู ูุตู ูููู ูุนูู.

## ๐๏ธ ููููุงุช ุงููุธุงู (ุงูุจูุงูุงุช ุงูุชู ูุนุชูุฏ ุนูููุง)

### 1. ุงูุฅุนุฏุงุฏุงุช (ุงูุดุฑูุท)
- **ุฃูุฒุงู ุงูููุงุฏ:** ุชุตููู ุงูููุงุฏ (ุซูููุฉ/ุฎูููุฉ) ูุนุฏู ูุถุน 3 ุญุตุต ุซูููุฉ ูุชุชุงููุฉ ููุทุงูุจ.
- **ุชููุฑ ุงููุนูููู:** ุงูุฃูุงู ุงูุชู ูููู ูููุง ุงููุนูู ูุชุงุญุงู.
- **ุงููููุฏ ุงูููุงููุฉ:** ุงูููุงุฏ ุงูุชู ุชุชุทูุจ ูุนุงููุงู ุฃู ูุงุนุงุช ุฎุงุตุฉ.

### 2. ุงููุญุฑู (ุจูุงุก ุงูุฌุฏูู)
- **ุงูุฅุตุฏุงุฑุงุช:** ุฅููุงููุฉ ุนูู ุฌุฏูู "ูุณูุฏุฉ 1"ุ ุซู ุชุนุฏููู ูู "ูุณูุฏุฉ 2" ูุจู ุงูุงุนุชูุงุฏ ุงูููุงุฆู.
- **ุงููุญุงูุงุฉ:** ุงุฎุชุจุงุฑ ุงูุฌุฏูู ุจุญุซุงู ุนู ุฃู ุซุบุฑุงุช ูุจู ูุดุฑู.

### 3. ุงููุฎุฑุฌุงุช ูุงูุชูุงุฑูุฑ
- **ุงูุฌุฏูู ุงูุนุงู:** ููุญุฉ ูุจูุฑุฉ ุชูุถุญ ุฎุฑูุทุฉ ุงููุฏุฑุณุฉ ุจุงููุงูู.
- **ุฌุฏูู ุงููุนูู:** ูุฑูุฉ ุฎุงุตุฉ ุจูู ูุนูู ุชูุถุญ ุญุตุตู ูุฃูุงูููุง.

## ๐ ุฃูุซูุฉ ูุงูุนูุฉ ูู ุฏุงุฎู ุงููุฏุฑุณุฉ
- **ุงููููู:** ูุชุตู ูุนูู ููุงุนุชุฐุงุฑ ุนู ุงูุญุถูุฑ ุบุฏุงู ูุธุฑู ุทุงุฑุฆ. ููุชุญ ุงููููู ุงููุธุงูุ ููุญุฏุฏ ุงููุนูููู ุงูุฐูู ูุฏููู "ุญุตุฉ ูุฑุงุบ" ูู ููุณ ููุช ุญุตุต ุงููุนูู ุงูุบุงุฆุจุ ูููุฒุน ุญุตุต ุงูุงุญุชูุงุท ุนูููู ูู ุฏูููุฉ.
- **ุงููุนูู:** ูุทูุจ ุฃู ูููู ููู ุงูุซูุงุซุงุก "ููู ุฑุงุญุฉ" ุฃู ุญุตุต ููููุฉ ูุธุฑูู ุฏุฑุงุณุชู ุงููุณุงุฆูุฉ. ูุฏุฎู ุงููููู ูุฐุง ุงูุดุฑุทุ ููููู ุงููุธุงู ุจุฅุนุงุฏุฉ ุชุฑุชูุจ ุงูุญุตุต ูุชุญููู ุงูุฑุบุจุฉ ุฏูู ุงูุฅุฎูุงู ุจุงููุธุงู ุงูุนุงู.

## ๏ฟฝ ููุงุฑูุฉ ุจุงูุทุฑููุฉ ุงูุชูููุฏูุฉ

| ุงูููุฒุฉ | ุงูุทุฑููุฉ ุงููุฏููุฉ (ุงูููุญุฉ ุงููุบูุงุทูุณูุฉ) | ูุธุงู ุงูุฌุฏูู ุงูุฐูู |
|--------|--------------------------------------|-------------------|
| **ุงูููุช ุงููุณุชุบุฑู** | ุฃุณุจูุน ุฃู ุฃูุซุฑ ูุน ูุฑูู ุนูู | ุฏูุงุฆู ูุนุฏูุฏุฉ |
| **ุงูุฏูุฉ** | ุงุญุชูุงู ูุจูุฑ ููุณูุงู ุญุตุฉ ุฃู ุชุนุงุฑุถ | ูุณุจุฉ ุฎุทุฃ 0% (ูููุน ุงููุธุงู ุงูุชุนุงุฑุถ ุชูููุงู) |
| **ุงูุชุนุฏูู** | ุฃู ุชุบููุฑ ุจุณูุท ูุฏ ูููุจ ุงูุฌุฏูู ุฑุฃุณุงู ุนูู ุนูุจ | ุฅุนุงุฏุฉ ุชูุฒูุน ุฐููุฉ ุชุญุงูุธ ุนูู ุซุจุงุช ุงูุฌุฏูู |

## โ ุฃุณุฆูุฉ ุดุงุฆุนุฉ (FAQ)
**ุณ: ูู ูุถุน ุงููุธุงู ุญุตุต ุงูุชุฑุจูุฉ ุงูุฑูุงุถูุฉ ูู ููุงูุฉ ุงูููู ุฏุงุฆูุงูุ**
ุฌ: ูููู ุจุฑูุฌุฉ ุงููุธุงู ูููุถู ุฐููุ ุฃู ูููุฒุนูุง ูููุงุตู ูุดุงุท ุจูู ุงูุญุตุต ุงูุฏุณูุฉ.

**ุณ: ูุงุฐุง ูู ูุงู ุนุฏุฏ ุงููุนูููู ุบูุฑ ูุงููุ**
ุฌ: ุณููุจูู ุงููุธุงู ุจูุฌูุฏ "ุญุตุต ููุชุฉ" ูุง ููุฌุฏ ูู ูุบุทููุงุ ูุชุชุฏุงุฑู ุงูุฃูุฑ ุจุชูุธูู ูุนูู ุฌุฏูุฏ ุฃู ุฒูุงุฏุฉ ุงููุตุงุจ.

## ๐ ุงูุฎูุงุตุฉ ุงูุชูููุฐูุฉ
ูุธุงู ุฌุฏูู ุงูุญุตุต ุงูุฐูู ูู **ูุงูุณุชุฑู ุงููุฏุฑุณุฉ**. ูุถุจุท ุฅููุงุน ุงูููู ุงูุฏุฑุงุณู ุจุฏูุฉ ูุชูุงููุฉุ ููุญูู ุนูููุฉ ุงูุชุฎุทูุท ุงููุนูุฏุฉ ุฅูู ุชุฌุฑุจุฉ ุชูููุฉ ููุชุนุฉุ ููุง ูุถูู ุณูุฑ ุงูุนูููุฉ ุงูุชุนููููุฉ ุจุณูุงุณุฉ ููุฏูุก.

---

## ๐จ ุขููุฉ ุงูุชูุฒูุน (Distribution Engine)

```mermaid
graph TD
    Input[๐ฅ ุงููุฏุฎูุงุช] -->|ูุนูููู + ูุตูู + ููุงุฏ| Engine[โ๏ธ ูุญุฑู ุงูุฌุฏููุฉ]
    Constraints[โ ุงููููุฏ] -->|ูุง ุญุตุต 7 + ููู ุฅุฌุงุฒุฉ| Engine
    
    Engine -->|ูุญุงูู| Draft1[๐ ูุณูุฏุฉ 1]
    Draft1 -->|ูุญุต ุชุนุงุฑุถ| Simulation[๐งช ูุญุงูู ุงูุชุนุงุฑุถุงุช]
    
    Simulation -->|ููุฌุฏ ุชุนุงุฑุถ| Solve[๐ง ุฎูุงุฑุฒููุฉ ุงูุญู]
    Solve -->|ูุญุงููุฉ ุฌุฏูุฏุฉ| Engine
    
    Simulation -->|ุณููู 100%| Final[โ ุงูุฌุฏูู ุงูููุงุฆู]
    Final -->|ูุดุฑ| Teachers[๐จโ๐ซ ุงููุนูููู]
    Final -->|ูุดุฑ| Students[๐จโ๐ ุงูุทูุงุจ]
```

## ๏ฟฝ๐ฏ ุงูุฑุคูุฉ ุงูุชูููุฉ (Intelligence Layer)
ูุฐุง ุงููุธุงู ููุณ ูุฌุฑุฏ "ุณุฌู ุญุตุต"ุ ุจู ูู **Scheduling Engine** ูุชูุงูู ูุฏุนู ุงููุญุงูุงุฉ (Simulation)ุ ูุฅุฏุงุฑุฉ ุงููููุฏ ุงููุนูุฏุฉุ ูููุงุฒูุฉ ุงูุฃุญูุงู ุงูููุนูุฉ ูููุนูููู.

---

## ๏ฟฝ ุงููููุฒุงุช ุงููุชูุฏูุฉ (Refactor 2.0)

1.  **ุงููุตุทูุญุงุช ุงูููุญุฏุฉ (Lookup Types):** ุชู ุชุญููู ุฃููุงุน ุงูุญุตุต ุฅูู ุฌุฏุงูู ูุฑุฌุนูุฉ (`NORMAL`, `ACTIVITY`, `SUBSTITUTE`, `EMERGENCY`) ูุถูุงู ุตุญุฉ ุงูุชูุงุฑูุฑ.
2.  **ุงูุชููุฑ ุงูุฒููู (Temporal Availability):** ุฏุนู ุงูุญุงูุงุช ุงููุคูุชุฉ ูููุนูููู ุนุจุฑ ุญููู `effective_from` ู `effective_to` ูู ุฌุฏูู ุชููุฑ ุงููุนูููู.
3.  **ุชุฏููู ุฃุฏุงุก ุงููุญุงูุงุฉ:** ุชุชุจุน ุฏููู ูููุช ุงูุชูููุฐ ุจุงูููู ุซุงููุฉ (`execution_time_ms`) ูุงููุณุชุฎุฏู ุงููููุฐุ ูุถูุงู ุงุณุชูุฑุงุฑ ุงูุฃุฏุงุก ูู ุงููุฏุงุฑุณ ุงููุจูุฑุฉ.
4.  **ุญูููุฉ ุงูุชุนุงุฑุถุงุช:** ุงูุณูุงุญ ุจุชุฎุฒูู ุงูุชุนุงุฑุถุงุช ูู ุงููุณูุฏุฉ ููุชู ุงูุชุดุงููุง ุนุจุฑ "ูุญุฑู ุงููุญุงูุงุฉ" (Simulation Engine)ุ ููุง ูุนุทู ูุฑููุฉ ูููุฌุฏูู ูู ุงูุชุนุงูู ูุน ุงูุญุงูุงุช ุงูุตุนุจุฉ.

---

# ๐ ูุงููุณ ุงูุจูุงูุงุช (Samples)

## 1๏ธโฃ ุฅุตุฏุงุฑุงุช ุงูุฌุฏูู (timetable_versions)
| ุงูุญูู | ุงููุตู | ุงูููุทู ุงูุจุฑูุฌู |
|--------|-------|----------------|
| `total_conflicts` | ุฅุฌูุงูู ุงูุชุนุงุฑุถุงุช | ููุญุณุจ ุขููุงู ุนุจุฑ ูุญุฑู ุงููุญุงูุงุฉ |
| `status_id` | ุญุงูุฉ ุงูุฅุตุฏุงุฑ | ูุณูุฏุฉ -> ูุญุงูุงุฉ -> ูุนุชูุฏ |

---

## 2๏ธโฃ ุญุตุต ุงูุฌุฏูู (timetable_slots)
| ุงูุญูู | ุงููุตู | ููุงุญุธุงุช |
|--------|-------|---------|
| `slot_type_id` | ููุน ุงูุญุตุฉ | ูุฑุชุจุท ุจุงูุจููุฉ ุงููุดุชุฑูุฉ |
| `is_fixed` | ุญุตุฉ ูุซุจุชุฉ | ูุง ูููู ูุญุฑู ุงูุชูุฒูุน ุงูุชููุงุฆู ุจุชุบููุฑูุง |

---

## 3๏ธโฃ ูุญุฑู ุงููุญุงูุงุฉ (Simulation Engine)
| ุงูุฌุฏูู | ุงููุตู | ุงูุญููู ุงูุฑุฆูุณูุฉ |
|--------|-------|----------------|
| `simulation_runs` | ุณุฌู ุงูุชุดุบูู | `execution_time_ms`, `run_by_user_id` |
| `simulation_conflicts` | ุณุฌู ุงูุฃุนุทุงู | `severity`, `suggested_fix`, `is_resolved` |

---

## ๐ ุฑูุงุจุท ุงูุชูุงูู
- **ุงูููุงุฉ ุงูุฃูุงุฏูููุฉ (02):** ููุตุฏุฑ ุงูุตูููุ ุงูุดุนุจุ ูุงูููุงุฏ.
- **ุงูููุงุฑุฏ ุงูุจุดุฑูุฉ (03):** ูุฑุจุท ุงูุฌุฏุงูู ุจุงููุนูููู ุงููุนูููู.
- **ุงูุจููุฉ ุงููุดุชุฑูุฉ (01):** ูููุตุทูุญุงุช ุงููุฑุฌุนูุฉ ูุฃูุงู ุงูุฃุณุจูุน.

---
**ุดุฑูุฉ ุฅููุง ุณููุช ููุญููู ุงูุชูููุฉ** | 2026

---

## ๐ก ููู ูุณุชุฎุฏู ุงููุจุฑูุฌ ูุฐุง ุงููุธุงูุ (SQL Examples)

### 1. ูุดู ุชุนุงุฑุถ ุงููุนูููู (Conflict Detection)
```sql
SELECT 
    t1.teacher_id,
    e.full_name,
    t1.day_of_week,
    t1.period_no,
    c1.name_ar AS class1,
    c2.name_ar AS class2
FROM timetable_slots t1
JOIN timetable_slots t2 
    ON t1.teacher_id = t2.teacher_id 
    AND t1.day_of_week = t2.day_of_week 
    AND t1.period_no = t2.period_no
    AND t1.id < t2.id
JOIN employees e ON t1.teacher_id = e.id
JOIN classes c1 ON t1.class_id = c1.id
JOIN classes c2 ON t2.class_id = c2.id
WHERE t1.version_id = (SELECT id FROM timetable_versions WHERE is_active = 1);
```

### 2. ุชูุฒูุน ุฃูุตุจุฉ ุงููุนูููู (Teacher Workload)
```sql
SELECT 
    e.full_name,
    COUNT(ts.id) AS assigned_periods,
    e.max_periods_per_week AS contract_limit,
    (e.max_periods_per_week - COUNT(ts.id)) AS remaining_capacity
FROM employees e
LEFT JOIN timetable_slots ts ON e.id = ts.teacher_id AND ts.version_id = 105
GROUP BY e.id
ORDER BY remaining_capacity DESC;
```

---

**ุดุฑูุฉ ุฅููุง ุณููุช ููุญููู ุงูุชูููุฉ** | 2026
