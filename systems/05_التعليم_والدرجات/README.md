# نظام التعليم والدرجات (System 05)
## دليل تشغيلي واضح للمستخدم والإدارة والمطور

هذا النظام هو قلب العمل الأكاديمي في المدرسة: من سياسة الدرجات، إلى الاختبارات والواجبات، ثم المحصلة الشهرية، ثم النتيجة النهائية والترتيب.

## لمن هذا الدليل؟

| الفئة | ماذا تستفيد؟ |
|---|---|
| الإدارة | فهم دورة النتيجة كاملة وضبط الحوكمة |
| المعلم | معرفة أين تُدخل كل نوع من البيانات |
| المطور | فهم الجداول والعلاقات والإجراءات بدون تعارض |

## خريطة الأنظمة الفرعية

| الترتيب | النظام الفرعي | الهدف | ملف المخطط | ملف الشرح |
|---|---|---|---|---|
| 1 | سياسات الدرجات | تعريف الأوزان وقواعد النجاح وتكليف المعلمين | `01_سياسات_الدرجات/DDL_POLICIES.sql` | `01_سياسات_الدرجات/README_POLICIES.md` |
| 2 | الاختبارات والفترات | إدارة الفترات ورصد درجات الاختبارات | `02_الاختبارات_والفترات/DDL_EXAMS.sql` | `02_الاختبارات_والفترات/README_EXAMS.md` |
| 3 | الواجبات المنزلية | تعريف الواجبات ورصد التنفيذ لكل طالب | `03_الواجبات_المنزلية/DDL_HOMEWORKS.sql` | `03_الواجبات_المنزلية/README_HOMEWORKS.md` |
| 4 | المحصلة الشهرية | حساب الدرجة الشهرية آليًا + عناصر يدوية | `04_المحصلة_الشهرية/DDL_MONTHLY.sql` | `04_المحصلة_الشهرية/README_MONTHLY.md` |
| 5 | نتائج الفصل والعام | حساب نتيجة الفصل/العام/قرار النقل | `05_نتائج_الفصل_والعام/DDL_RESULTS.sql` | `05_نتائج_الفصل_والعام/README_RESULTS.md` |
| 6 | تحضير الدروس | متابعة جودة التحضير واعتماده | `06_تحضير_الدروس/DDL_LESSON_PREP.sql` | `06_تحضير_الدروس/README_LESSON_PREP.md` |
| 7 | التدقيق والحوكمة | منع العبث بعد الاعتماد + تتبع التعديلات | `07_التدقيق_والحوكمة/DDL_AUDIT.sql` | `07_التدقيق_والحوكمة/README_AUDIT.md` |
| 8 | التقارير والمخرجات | توليد عرض مفهوم للنسب والتقديرات والترتيب | `08_التقارير_والمخرجات/DDL_REPORTS.sql` | `08_التقارير_والمخرجات/README_REPORTS.md` |
| 9 | أدوات النسخ السنوي | نسخ إعدادات عام إلى عام جديد | `09_أدوات_النسخ_السنوي/DDL_TOOLS.sql` | `09_أدوات_النسخ_السنوي/README_TOOLS.md` |
| 10 | البيانات التجريبية والأمثلة | سيناريو تشغيلي كامل من السياسة إلى النتيجة | `10_البيانات_التجريبية_والأمثلة/DEMO_DATA.sql` | `10_البيانات_التجريبية_والأمثلة/README_END_TO_END_EXAMPLE.md` |

## كيف تمشي العملية بشكل مبسط؟

| المرحلة | ماذا يحدث؟ | المخرجات |
|---|---|---|
| 1. الإعداد | ضبط السياسة والأوزان وتكليف المعلمين | سياسة نشطة لكل صف/مادة |
| 2. التنفيذ اليومي | إدخال الواجبات والاختبارات والحضور | بيانات خام دقيقة |
| 3. الحساب الشهري | تحويل البيانات الخام إلى مجموع شهري | `monthly_grades` |
| 4. حساب الفصل | تجميع الأشهر + إضافة النهائي | `semester_grades` |
| 5. حساب العام | تجميع الفصلين + تطبيق قواعد القرار | `annual_grades`, `annual_result` |
| 6. الحوكمة والتقارير | قفل السجلات المعتمدة وإخراج التقارير | مخرجات موثوقة للإدارة وولي الأمر |

## نقطة حوكمة مهمة

| المتغير التشغيلي | الغرض | لماذا مهم؟ |
|---|---|---|
| `@current_user_id` | تعريف المستخدم الذي ينفذ التعديل | حتى يسجل التدقيق اسم المعدل الحقيقي |
| `@skip_teacher_assignment_check` | تجاوز تحقق التكليف للحالات النظامية | يستخدم فقط في أعمال النظام المجدولة |

## ترتيب التنفيذ العملي (بدون أوامر)
1. جهز النظام الفرعي 01 (السياسات والتكليفات).
2. جهز النظام الفرعي 02 (الفترات ودرجات الاختبارات).
3. جهز النظام الفرعي 03 (الواجبات).
4. شغّل النظام الفرعي 04 (الحساب الشهري).
5. شغّل النظام الفرعي 05 (نتائج الفصل والعام).
6. فعّل النظام الفرعي 06 و07 و08 (التحضير والحوكمة والتقارير).
7. استخدم النظام الفرعي 09 للنسخ السنوي.
8. استخدم النظام الفرعي 10 لاختبار رحلة تشغيل كاملة.

## ماذا ستجد في ملفات الشرح الفرعية؟
- شرح مبسط لغير التقني.
- شرح تقني منظم للمطور.
- تعريف الجداول والأعمدة مع ترجمة ومعنى كل عمود.
- سجلات توضيحية بجداول Markdown (وليس أوامر SQL).
- سير عمليات يومية واضح خطوة بخطوة.
