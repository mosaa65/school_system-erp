# ๐งญ ุดุฑุญ ูุธุงู ุงูุชุนููู ูู ุงูุฃูู ูููุงุก (ุณููุงุฑูู ุนููู)
## End-to-End Walkthrough with 10 Base Records

---

## ๐ฏ ุงููุฏู
ูุฐุง ุงูููู ูุดุฑุญ ุฏูุฑุฉ ุงููุธุงู ูุงููุฉ ุจุดูู ุนููู:
1. ูู ุชุนุฑูู ุงูุณูุงุณุฉ.
2. ุฅูู ุฑุตุฏ ุงููุงุฌุจ ูุงูุงุฎุชุจุงุฑ.
3. ุฅูู ุงููุญุตูุฉ ุงูุดูุฑูุฉ.
4. ุฅูู ูุชูุฌุฉ ุงููุตู.
5. ุฅูู ูุชูุฌุฉ ุงูุนุงู ููุฑุงุฑ ุงูููู.

> ููุงุญุธุฉ: ุนุฏุฏ **ุงูุณุฌูุงุช ุงูุฃุณุงุณูุฉ** ูู ุงููุซุงู = **10** ููุทุ ููุง ุจุนุฏูุง ููุงุชุฌ ุญุณุงุจ ุขูู ูู ุงูุฅุฌุฑุงุกุงุช (Procedures).

---

## 1) ุงูุณุฌูุงุช ุงูุฃุณุงุณูุฉ (10 ุณุฌูุงุช)

### 1.1 ุณูุงุณุฉ ุงูุฏุฑุฌุงุช (ุณุฌู 1)
| id | academic_year_id | grade_level_id | subject_id | max_exam_score | max_homework_score | max_attendance_score | max_activity_score | passing_score |
|----|------------------|----------------|------------|----------------|--------------------|----------------------|--------------------|---------------|
| 1 | 1 | 1 | 1 (ุฑูุงุถูุงุช) | 20.00 | 5.00 | 5.00 | 5.00 | 50.00 |

### 1.2 ุชุณุฌูู ุงูุทูุงุจ ูู ุงููุตู (ุณุฌูุงู 2-3)
| enrollment_id | student_id | classroom_id | is_active |
|---------------|------------|--------------|-----------|
| 501 | 101 (ูุญูุฏ) | 1 | TRUE |
| 502 | 102 (ูุฑูู) | 1 | TRUE |

### 1.3 ูุชุฑุฉ ุงูุชุญุงููุฉ (ุณุฌู 4)
| exam_period_id | academic_year_id | semester_id | name | type | start_date | end_date | created_by |
|----------------|------------------|-------------|------|------|------------|----------|------------|
| 11 | 1 | 1 | ุงุฎุชุจุงุฑ ุดูุฑ ูุญุฑู | MONTHLY | 2026-09-10 | 2026-09-20 | 1 |

### 1.4 ุฌุฏูู ุงุฎุชุจุงุฑ (ุณุฌู 5)
| exam_schedule_id | exam_period_id | subject_id | grade_level_id | exam_date | max_score | created_by |
|------------------|----------------|------------|----------------|-----------|-----------|------------|
| 21 | 11 | 1 (ุฑูุงุถูุงุช) | 1 | 2026-09-15 | 20.00 | 1 |

### 1.5 ูุงุฌุจ ููุฒูู (ุณุฌู 6)
| homework_id | academic_year_id | semester_id | month_id | classroom_id | subject_id | title | max_grade | created_by |
|-------------|------------------|-------------|----------|--------------|------------|-------|-----------|------------|
| 31 | 1 | 1 | 1 (ูุญุฑู) | 1 | 1 (ุฑูุงุถูุงุช) | ุญู ุชูุงุฑูู ุงูุจุงุจ ุงูุฃูู | 5.0 | 1 |

### 1.6 ุฑุตุฏ ุงููุงุฌุจุงุช ููุทูุงุจ (ุณุฌูุงู 7-8)
| student_homework_id | homework_id | enrollment_id | is_completed | manual_grade | submitted_at |
|---------------------|-------------|---------------|--------------|--------------|--------------|
| 41 | 31 | 501 | TRUE | NULL | 2026-09-18 10:00:00 |
| 42 | 31 | 502 | FALSE | NULL | NULL |

### 1.7 ุฏุฑุฌุงุช ุงูุงุฎุชุจุงุฑ ููุทูุงุจ (ุณุฌูุงู 9-10)
| student_exam_score_id | exam_schedule_id | enrollment_id | score | is_present | absence_type |
|-----------------------|------------------|---------------|-------|------------|--------------|
| 51 | 21 | 501 | 18.00 | TRUE | NULL |
| 52 | 21 | 502 | 12.00 | TRUE | NULL |

---

## 2) ูุงุฐุง ูุนูู ุงููุธุงู ุชููุงุฆูุง ุจุนุฏ ูุฐู ุงูุณุฌูุงุชุ

1. ุนูุฏ ุฅูุดุงุก `homeworks`:
`trg_homework_auto_populate` ูุณุชุฏุนู `sp_populate_student_homeworks` ูุฑุตุฏ ุงูุทูุงุจ ุชููุงุฆูุง.

2. ุนูุฏ ุฅูุดุงุก `exam_schedules`:
`trg_exam_schedule_auto_populate` ูุณุชุฏุนู `sp_populate_exam_scores` ูุฅูุดุงุก ุฏุฑุฌุงุช ุงุจุชุฏุงุฆูุฉ ููู ุงูุทูุงุจ.

3. ุนูุฏ ุญุณุงุจ ุงูุดูุฑ:
`sp_calculate_monthly_grades(month_id, subject_id, classroom_id)` ูุญุณุจ:
- `attendance_score` ูู ุงูุญุถูุฑ (System 04)
- `homework_score` ูู `v_homework_effective_grade`
- `exam_score` ูู `student_exam_scores`
- ููุญูุธ ูู `monthly_grades`

4. ุนูุฏ ุญุณุงุจ ุงููุตู:
`sp_calculate_semester_totals` ูุฌูุน ุงููุญุตูุงุช ุงูุดูุฑูุฉ ููู ูุงุฏุฉ/ุทุงูุจ ูู `semester_grades`.

5. ุนูุฏ ุญุณุงุจ ุงูุนุงู:
`sp_calculate_annual_results` ููุชุฌ `annual_grades` ุซู `annual_result` (ุงููุณุจุฉ + ุงูุชุฑุชูุจ + ูุฑุงุฑ ุงูููู).

---

## 3) ูุงุชุฌ ุงูุดูุฑ (ูุซุงู ูุนูู)

### 3.1 ุงูุชุฑุงุถ ุงูุญุถูุฑ ูู System 04
| enrollment_id | attendance_percentage | max_attendance_score | attendance_score |
|---------------|-----------------------|----------------------|------------------|
| 501 | 96% | 5.00 | 4.80 |
| 502 | 80% | 5.00 | 4.00 |

### 3.2 ุฏุฑุฌุฉ ุงููุงุฌุจ ุงููุนููุฉ
| enrollment_id | is_completed | max_grade | manual_grade | effective_grade |
|---------------|--------------|-----------|--------------|-----------------|
| 501 | TRUE | 5.0 | NULL | 5.0 |
| 502 | FALSE | 5.0 | NULL | 0.0 |

### 3.3 ุฌุฏูู `monthly_grades` (ูุงุชุฌ ุงูุฅุฌุฑุงุก)
| enrollment_id | subject_id | month_id | attendance_score | homework_score | activity_score | contribution_score | custom_components_score | exam_score | monthly_total |
|---------------|------------|----------|------------------|----------------|----------------|--------------------|-------------------------|------------|---------------|
| 501 | 1 | 1 | 4.80 | 5.00 | 4.50 | 0.00 | 0.00 | 18.00 | 32.30 |
| 502 | 1 | 1 | 4.00 | 0.00 | 4.00 | 0.00 | 0.00 | 12.00 | 20.00 |

> ุงููุนุงุฏูุฉ:  
`monthly_total = attendance_score + homework_score + activity_score + contribution_score + custom_components_score + exam_score`

---

## 4) ูุงุชุฌ ุงููุตู ุงูุฏุฑุงุณู (ูุซุงู)

ููุชุฑุถ ุฃู ูุฌููุน ุฃุนูุงู ุงููุตู ุชู ุญุณุงุจู ุซู ุชู ุชุฑุญูู ุงูููุงุฆู:

| enrollment_id | subject_id | semester_id | semester_work_total | final_exam_score | semester_total |
|---------------|------------|-------------|---------------------|------------------|----------------|
| 501 | 1 | 1 | 19.50 | 12.00 | 31.50 |
| 502 | 1 | 1 | 13.00 | 8.00 | 21.00 |

> ููุทู ุงูุญูู ุงููุญุณูุจ:  
`semester_total = semester_work_total + final_exam_score`

---

## 5) ูุงุชุฌ ุงูุนุงู ููุฑุงุฑ ุงูููู (ูุซุงู)

### 5.1 `annual_grades` (ููู ูุงุฏุฉ)
ููุชุฑุถ ุงููุตู ุงูุซุงูู ูุงูุชุงูู: ูุญูุฏ `30.50`ุ ูุฑูู `24.00`.

| enrollment_id | subject_id | academic_year_id | semester1_total | semester2_total | annual_total | annual_percentage | final_status |
|---------------|------------|------------------|-----------------|-----------------|-------------|-------------------|-------------|
| 501 | 1 | 1 | 31.50 | 30.50 | 62.00 | 88.57% | PASS |
| 502 | 1 | 1 | 21.00 | 24.00 | 45.00 | 64.29% | PASS |

### 5.2 `annual_result` (ุงููุชูุฌุฉ ุงูุดุงููุฉ)
| enrollment_id | total_all_subjects | max_possible_total | percentage | rank_in_class | passed_subjects_count | failed_subjects_count | promotion_decision |
|---------------|--------------------|--------------------|------------|---------------|------------------------|-----------------------|-------------------|
| 501 | 62.00 | 70.00 | 88.57% | 1 | 1 | 0 | PROMOTED |
| 502 | 45.00 | 70.00 | 64.29% | 2 | 1 | 0 | PROMOTED |

---

## 6) ููู ูุทูุน ุงูุชูุฑูุฑ ุงูููุงุฆู ููุทุงูุจุ

ุงูุชูุฑูุฑ ุงูุดูุฑู ูุนุชูุฏ ุนูู:
- `v_rpt_monthly_subject_details` (ุชูุตูู ุงููุงุฏุฉ)
- `v_rpt_monthly_student_summary` (ุงูููุฎุต ุงูุนุงู)
- `fn_get_grade_description` (ูุตู ุงูุชูุฏูุฑ)

ูุซุงู ุดูู ูุชูุฌุฉ ุงูุทุงูุจ ูุญูุฏ ูู ุงูุดูุฑ:

| ุงููุงุฏุฉ | ููุงุธุจุฉ | ูุงุฌุจุงุช | ูุดุงุท | ุงุฎุชุจุงุฑ | ุงููุฌููุน | ุงูุชูุฏูุฑ |
|--------|--------|--------|------|--------|---------|---------|
| ุงูุฑูุงุถูุงุช | 4.80 | 5.00 | 4.50 | 18.00 | 32.30 | ููุชุงุฒ |

---

## 7) SQL ูุฎุชุตุฑ ูุชุฌุฑุจุฉ ููุณ ุงูุณููุงุฑูู

```sql
-- 1) ุญุณุงุจ ุงููุญุตูุฉ ุงูุดูุฑูุฉ
CALL sp_calculate_monthly_grades(1, 1, 1);

-- 2) ุญุณุงุจ ูุฌุงููุน ุงููุตู
CALL sp_calculate_semester_totals(1, 1, 1);

-- 3) ุณุญุจ ุงูููุงุฆู ูููุตู (ุฅุฐุง ููุฌูุฏ ุงูุชุญุงู FINAL)
CALL sp_fill_final_exam_score(1, 1);

-- 4) ุญุณุงุจ ุงููุชุงุฆุฌ ุงูุณูููุฉ + ูุฑุงุฑ ุงูููู
CALL sp_calculate_annual_results(1, 1);
```

---

## โ ุงูุฎูุงุตุฉ ุงูุณุฑูุนุฉ
ุฅุฐุง ูููุช ูุฐุง ุงูุชุณูุณูุ ูุฃูุช ูููุช ุงููุธุงู ูุงูู:
1. ุณูุงุณุฉ ุฏุฑุฌุงุช.
2. ูุงุฌุจุงุช ูุงุฎุชุจุงุฑุงุช.
3. ุญุณุงุจ ุดูุฑู.
4. ุญุณุงุจ ูุตูู.
5. ุญุณุงุจ ุณููู.
6. ุชูุฑูุฑ ููุฑุงุฑ ููู.

**ุชู ุงูุฅูุดุงุก:** 2026-02-14
